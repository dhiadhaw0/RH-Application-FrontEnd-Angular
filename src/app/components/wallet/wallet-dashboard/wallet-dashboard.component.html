<div class="wallet-dashboard">
  <!-- Header -->
  <div class="dashboard-header">
    <div class="header-content">
      <h1><i class="fas fa-wallet"></i> Digital Wallet</h1>
      <div class="wallet-selector" *ngIf="wallets.length > 1">
        <select [(ngModel)]="currentWallet" (change)="selectWallet(currentWallet)">
          <option *ngFor="let wallet of wallets" [ngValue]="wallet">
            {{ wallet.walletNumber }} ({{ formatCurrency(wallet.balance, wallet.currency) }})
          </option>
        </select>
      </div>
    </div>
  </div>

  <!-- Main Content -->
  <div class="dashboard-content" *ngIf="currentWallet">
    <!-- Balance Card -->
    <div class="balance-card">
      <div class="balance-header">
        <h2>Current Balance</h2>
        <span class="currency-badge">{{ currentWallet.currency }}</span>
      </div>
      <div class="balance-amount">
        {{ formatCurrency(currentWallet.balance, currentWallet.currency) }}
      </div>
      <div class="balance-actions">
        <button class="btn btn-primary" (click)="addFunds(quickAmounts[0])">
          <i class="fas fa-plus"></i> Add $25
        </button>
        <button class="btn btn-outline-primary" (click)="withdrawFunds(quickAmounts[0])">
          <i class="fas fa-minus"></i> Withdraw $25
        </button>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <h3>Quick Actions</h3>
      <div class="action-buttons">
        <button *ngFor="let amount of quickAmounts" class="action-btn" (click)="addFunds(amount)">
          <i class="fas fa-plus-circle"></i>
          <span>Add ${{ amount }}</span>
        </button>
      </div>
    </div>

    <!-- Recent Transactions -->
    <div class="transactions-section">
      <div class="section-header">
        <h3>Recent Transactions</h3>
        <button class="btn btn-link" (click)="navigateToTransactions()">
          View All <i class="fas fa-arrow-right"></i>
        </button>
      </div>
      <div class="transactions-list">
        <div *ngFor="let transaction of recentTransactions" class="transaction-item">
          <div class="transaction-icon">
            <i [class]="getTransactionIcon(transaction.type)"></i>
          </div>
          <div class="transaction-details">
            <div class="transaction-description">{{ transaction.description }}</div>
            <div class="transaction-date">{{ formatDate(transaction.createdAt) }}</div>
          </div>
          <div class="transaction-amount" [ngClass]="getTransactionColor(transaction.type)">
            <span *ngIf="transaction.amount > 0">+</span>{{ formatCurrency(transaction.amount, transaction.currency) }}
          </div>
        </div>
        <div *ngIf="recentTransactions.length === 0" class="no-transactions">
          <i class="fas fa-receipt"></i>
          <p>No transactions yet</p>
        </div>
      </div>
    </div>

    <!-- Payment Methods & Subscriptions -->
    <div class="bottom-section">
      <!-- Payment Methods -->
      <div class="payment-methods-card">
        <div class="card-header">
          <h4><i class="fas fa-credit-card"></i> Payment Methods</h4>
          <button class="btn btn-sm btn-outline-primary" (click)="navigateToPaymentMethods()">
            Manage
          </button>
        </div>
        <div class="payment-methods-list">
          <div *ngFor="let method of paymentMethods.slice(0, 2)" class="payment-method-item">
            <div class="method-icon">
              <i [class]="paymentMethodService.getPaymentMethodIcon(method.type, method.provider)"></i>
            </div>
            <div class="method-details">
              <div class="method-name">{{ method.nickname || 'Card ending in ' + method.lastFour }}</div>
              <div class="method-type">{{ method.type.replace('_', ' ') }}</div>
            </div>
            <div class="method-status" *ngIf="method.isDefault">
              <span class="badge badge-primary">Default</span>
            </div>
          </div>
          <div *ngIf="paymentMethods.length === 0" class="no-methods">
            <p>No payment methods added</p>
            <button class="btn btn-sm btn-primary" (click)="navigateToPaymentMethods()">Add Method</button>
          </div>
        </div>
      </div>

      <!-- Active Subscriptions -->
      <div class="subscriptions-card">
        <div class="card-header">
          <h4><i class="fas fa-sync-alt"></i> Active Subscriptions</h4>
          <button class="btn btn-sm btn-outline-primary" (click)="navigateToSubscriptions()">
            Manage
          </button>
        </div>
        <div class="subscriptions-list">
          <div *ngFor="let subscription of activeSubscriptions.slice(0, 2)" class="subscription-item">
            <div class="subscription-icon">
              <i class="fas fa-calendar-alt"></i>
            </div>
            <div class="subscription-details">
              <div class="subscription-name">{{ subscription.name }}</div>
              <div class="subscription-amount">{{ formatCurrency(subscription.amount, subscription.currency) }}/{{ subscription.frequency.toLowerCase() }}</div>
            </div>
            <div class="subscription-status">
              <span class="badge" [ngClass]="subscription.status === 'ACTIVE' ? 'badge-success' : 'badge-warning'">
                {{ subscription.status }}
              </span>
            </div>
          </div>
          <div *ngIf="activeSubscriptions.length === 0" class="no-subscriptions">
            <p>No active subscriptions</p>
            <button class="btn btn-sm btn-primary" (click)="navigateToSubscriptions()">View Plans</button>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Loading State -->
  <div *ngIf="isLoading" class="loading-state">
    <div class="spinner-border text-primary" role="status">
      <span class="sr-only">Loading...</span>
    </div>
    <p>Loading wallet data...</p>
  </div>
</div>
