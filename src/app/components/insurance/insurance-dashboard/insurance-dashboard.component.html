<div class="insurance-dashboard">
  <div class="dashboard-header">
    <div class="header-content">
      <h1><i class="fas fa-shield-alt"></i> Assurance Emploi Post-Formation</h1>
      <p class="dashboard-subtitle">Protection et sécurité après vos formations</p>
    </div>
    <div class="header-decoration">
      <div class="shield-icon">
        <i class="fas fa-shield-alt"></i>
      </div>
    </div>
  </div>

  <div class="auth-notice" *ngIf="!currentUser">
    <div class="notice-card">
      <div class="notice-icon">
        <i class="fas fa-info-circle"></i>
      </div>
      <div class="notice-content">
        <h4>Découvrez nos assurances</h4>
        <p>Connectez-vous pour voir vos polices d'assurance personnelles et gérer vos réclamations.</p>
        <div class="notice-actions">
          <button class="btn btn-primary" routerLink="/login">Se connecter</button>
          <button class="btn btn-outline" routerLink="/register">S'inscrire</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Statistics Cards -->
  <div class="stats-section" *ngIf="insuranceStats">
    <div class="stats-grid">
      <div class="stat-card primary">
        <div class="stat-icon">
          <i class="fas fa-file-contract"></i>
        </div>
        <div class="stat-content">
          <h3>{{ insuranceStats.totalPolicies }}</h3>
          <p>Total des polices</p>
        </div>
      </div>
      <div class="stat-card success">
        <div class="stat-icon">
          <i class="fas fa-check-circle"></i>
        </div>
        <div class="stat-content">
          <h3>{{ insuranceStats.activePolicies }}</h3>
          <p>Polices actives</p>
        </div>
      </div>
      <div class="stat-card warning">
        <div class="stat-icon">
          <i class="fas fa-hand-holding-usd"></i>
        </div>
        <div class="stat-content">
          <h3>{{ insuranceStats.claimedPolicies }}</h3>
          <p>Réclamations</p>
        </div>
      </div>
      <div class="stat-card info">
        <div class="stat-icon">
          <i class="fas fa-euro-sign"></i>
        </div>
        <div class="stat-content">
          <h3>{{ formatCurrency(insuranceStats.totalCoverageAmount) }}</h3>
          <p>Couverture totale</p>
        </div>
      </div>
    </div>
  </div>

  <!-- User Insurances Section -->
  <div class="insurances-section">
    <div class="section-header">
      <h2><i class="fas fa-list"></i> Mes Assurances</h2>
    </div>

    <div *ngIf="loading" class="loading-state">
      <div class="loading-spinner">
        <i class="fas fa-spinner fa-spin"></i>
        <p>Chargement de vos assurances...</p>
      </div>
    </div>

    <div *ngIf="!loading && userInsurances.length === 0" class="empty-state">
      <div class="empty-icon">
        <i class="fas fa-shield-alt"></i>
      </div>
      <h3>Aucune assurance trouvée</h3>
      <p>Vous n'avez pas encore d'assurance active. Complétez une formation payante pour être éligible à notre protection emploi.</p>
      <button class="btn btn-primary" routerLink="/formations">
        <i class="fas fa-graduation-cap"></i>
        Découvrir les formations
      </button>
    </div>

    <div *ngIf="!loading && userInsurances.length > 0" class="insurances-grid">
      <div class="insurance-card" *ngFor="let insurance of userInsurances">
        <div class="card-header">
          <div class="formation-info">
            <h4>{{ insurance.formation?.title }}</h4>
            <p class="formation-price">{{ formatCurrency(insurance.formation?.prix || 0) }}</p>
          </div>
          <div class="status-badge" [ngClass]="getStatusClass(insurance.status)">
            {{ getStatusLabel(insurance.status) }}
          </div>
        </div>

        <div class="card-body">
          <div class="coverage-amount">
            <div class="amount-icon">
              <i class="fas fa-euro-sign"></i>
            </div>
            <div class="amount-info">
              <h3>{{ formatCurrency(insurance.coverageAmount) }}</h3>
              <p>Montant de couverture</p>
            </div>
          </div>

          <div class="dates-info">
            <div class="date-item">
              <i class="fas fa-calendar-start"></i>
              <span>Début: {{ formatDate(insurance.startDate) }}</span>
            </div>
            <div class="date-item">
              <i class="fas fa-calendar-end"></i>
              <span>Fin: {{ formatDate(insurance.endDate) }}</span>
            </div>
          </div>
        </div>

        <div class="card-actions">
          <button
            *ngIf="canClaimInsurance(insurance)"
            class="btn btn-warning claim-btn"
            (click)="claimInsurance(insurance.id)">
            <i class="fas fa-hand-holding-usd"></i>
            Réclamer maintenant
          </button>
          <div *ngIf="!canClaimInsurance(insurance)" class="waiting-state">
            <i class="fas fa-clock"></i>
            <span>En attente de période d'éligibilité</span>
          </div>
        </div>
      </div>
    </div>
  </div>

  <!-- Information Section -->
  <div class="how-it-works-section">
    <div class="section-header">
      <h2><i class="fas fa-info-circle"></i> Comment ça marche ?</h2>
    </div>

    <div class="steps-grid">
      <div class="step-card">
        <div class="step-number">1</div>
        <div class="step-icon">
          <i class="fas fa-graduation-cap"></i>
        </div>
        <div class="step-content">
          <h4>Formation payante</h4>
          <p>Complétez une formation payante pour être éligible à l'assurance emploi.</p>
        </div>
      </div>

      <div class="step-card">
        <div class="step-number">2</div>
        <div class="step-icon">
          <i class="fas fa-shield-alt"></i>
        </div>
        <div class="step-content">
          <h4>Couverture automatique</h4>
          <p>Une assurance est automatiquement créée avec une couverture de 6 mois.</p>
        </div>
      </div>

      <div class="step-card">
        <div class="step-number">3</div>
        <div class="step-icon">
          <i class="fas fa-hand-holding-usd"></i>
        </div>
        <div class="step-content">
          <h4>Réclamation</h4>
          <p>Si vous n'avez pas trouvé d'emploi après 6 mois, vous pouvez réclamer la couverture.</p>
        </div>
      </div>
    </div>

    <div class="info-banner">
      <div class="banner-icon">
        <i class="fas fa-lightbulb"></i>
      </div>
      <div class="banner-content">
        <h4>À propos de la couverture</h4>
        <p>Le montant de couverture est calculé en fonction des statistiques d'embauche des offres d'emploi disponibles sur la plateforme.</p>
      </div>
    </div>
  </div>
</div>
