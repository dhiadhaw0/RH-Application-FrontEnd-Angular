<div class="document-viewer-container">
  <div class="viewer-header">
    <button class="back-btn" (click)="goBack()">
      ← Retour
    </button>
    <div class="document-info" *ngIf="document">
      <h1 class="doc-title">{{ document.name }}</h1>
      <div class="doc-meta">
        <span class="meta-item">📏 {{ getFileSizeDisplay(document.fileSize) }}</span>
        <span class="meta-item">📅 {{ document.uploadedAt | date:'dd/MM/yyyy HH:mm' }}</span>
        <span class="meta-item">📄 {{ document.mimeType }}</span>
      </div>
    </div>
    <button class="download-btn" (click)="downloadDocument()" *ngIf="document">
      📥 Télécharger
    </button>
  </div>

  <div class="viewer-content">
    <div class="loading-state" *ngIf="loading">
      <div class="loading-spinner"></div>
      <p>Chargement du document...</p>
    </div>

    <div class="error-state" *ngIf="error && !loading">
      <div class="error-icon">⚠️</div>
      <h3>Erreur de chargement</h3>
      <p>{{ error }}</p>
      <button class="retry-btn" (click)="loadDocument()">
        Réessayer
      </button>
    </div>

    <div class="document-display" *ngIf="!loading && !error && documentUrl">
      <div class="pdf-viewer" *ngIf="isPdfDocument()">
        <iframe
          [src]="documentUrl"
          width="100%"
          height="600px"
          frameborder="0"
          class="pdf-iframe">
        </iframe>
      </div>

      <div class="image-viewer" *ngIf="isImageDocument()">
        <img
          [src]="documentUrl"
          alt="Document"
          class="document-image"
        />
      </div>

      <div class="unsupported-viewer" *ngIf="!isPdfDocument() && !isImageDocument()">
        <div class="unsupported-content">
          <div class="unsupported-icon">📄</div>
          <h3>Visualisation non disponible</h3>
          <p>Ce type de document ne peut pas être visualisé dans le navigateur.</p>
          <p>Veuillez utiliser le bouton "Télécharger" pour ouvrir le fichier.</p>
          <button class="download-alt-btn" (click)="downloadDocument()">
            📥 Télécharger le fichier
          </button>
        </div>
      </div>
    </div>
  </div>
</div>